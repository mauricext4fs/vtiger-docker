version: '2'
services:
    web-dev:
        image: nginx:alpine
        links:
            - php
        volumes:
            - ./etc/nginx/nginx.conf:/etc/nginx/nginx.conf
            - ./etc/nginx/options.include:/etc/nginx/options.include
            - ./etc/nginx/vtiger.conf:/etc/nginx/conf.d/dev.conf
            - ./vtigercrm:/var/www/html
        networks:
          www-gateway:
            aliases:
              - "vtiger.ninezh.cc"
        environment:
          - COMPOSE_PROJECT_NAME
          - VIRTUAL_HOST=vtiger.ninezh.cc
          - VIRTUAL_PORT=443

    php:
      image: mauricext4fs/docker-php7-alpine-imagic-openssl
      networks:
          www-gateway:
      volumes:
        - ./vtigercrm:/var/www/html

    mysql:
      image: mysql:5.7
      command: --sql_mode=ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION --character-set-server=utf8,--collation-server=utf8_general_ci
      networks:
          www-gateway:
      volumes:
        - ./varlibmysql:/var/lib/mysql
      environment:
        MYSQL_DATABASE: vtiger
        MYSQL_USER: vtiger
        MYSQL_PASSWORD: vtiger
        MYSQL_RANDOM_ROOT_PASSWORD: '1'

networks:
  www-gateway:
    external: true
